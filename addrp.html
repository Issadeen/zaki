<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report Form - ZAKI TRANSPORTERS</title>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="config.js"></script>
    <script src="auth.js"></script>

    <!-- SheetJS (for reading Excel files) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'custom-dark': '#0d1117',
                        'custom-dark-secondary': '#161b22',
                        'custom-accent': '#58a6ff',
                        'custom-accent-hover': '#79b6ff',
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>

    <!-- Particles.js -->
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .glass {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .modal {
            display: none; 
            position: fixed; 
            z-index: 1; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            background-color: #282c34;
            margin: 15% auto; 
            padding: 20px;
            border: 1px solid #555;
            width: 80%; 
            color: #f0f0f0;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-custom-dark text-white flex flex-col min-h-screen">
    <div id="particles-js" class="fixed inset-0 z-0"></div>

    <!-- Glassy top bar -->
    <nav class="bg-custom-dark-secondary bg-opacity-30 backdrop-filter backdrop-blur-lg sticky top-0 z-10 shadow-lg w-full">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center">
                <img src="logo.jpg" alt="Zaki Transporters Logo" class="h-10 w-10 mr-2 rounded-full border-2 border-custom-accent animate-pulse-slow">
                <h1 class="text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-custom-accent to-purple-400">ZAKI TRANSPORTERS</h1>
            </div>
        </div>
    </nav>

    <form id="reportForm" class="glass p-6 mt-10 w-11/12 max-w-2xl mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label for="date" class="block text-sm font-medium text-gray-300">Date:</label>
                <input type="date" id="date" name="date" class="mt-1 block w-full bg-custom-dark-secondary text-white border border-gray-600 rounded-md shadow-sm focus:ring-custom-accent focus:border-custom-accent">
            </div>
            <div>
                <label for="truckNo" class="block text-sm font-medium text-gray-300">Truck No:</label>
                <input type="text" id="truckNo" name="truckNo" class="mt-1 block w-full bg-custom-dark-secondary text-white border border-gray-600 rounded-md shadow-sm focus:ring-custom-accent focus:border-custom-accent">
            </div>
            <div>
                <label for="orderNo" class="block text-sm font-medium text-gray-300">Order No:</label>
                <input type="text" id="orderNo" name="orderNo" class="mt-1 block w-full bg-custom-dark-secondary text-white border border-gray-600 rounded-md shadow-sm focus:ring-custom-accent focus:border-custom-accent">
            </div>
            <div>
                <label for="loadingDepot" class="block text-sm font-medium text-gray-300">Loading Depot:</label>
                <input type="text" id="loadingDepot" name="loadingDepot" class="mt-1 block w-full bg-custom-dark-secondary text-white border border-gray-600 rounded-md shadow-sm focus:ring-custom-accent focus:border-custom-accent">
            </div>
            <div>
                <label for="customerName" class="block text-sm font-medium text-gray-300">Customer's Name:</label>
                <input type="text" id="customerName" name="customerName" class="mt-1 block w-full bg-custom-dark-secondary text-white border border-gray-600 rounded-md shadow-sm focus:ring-custom-accent focus:border-custom-accent">
            </div>
            <div>
                <label for="product" class="block text-sm font-medium text-gray-300">Product:</label>
                <input type="text" id="product" name="product" class="mt-1 block w-full bg-custom-dark-secondary text-white border border-gray-600 rounded-md shadow-sm focus:ring-custom-accent focus:border-custom-accent">
            </div>
            <div>
                <label for="volObs" class="block text-sm font-medium text-gray-300">Vol @OBS:</label>
                <input type="number" id="volObs" name="volObs" class="mt-1 block w-full bg-custom-dark-secondary text-white border border-gray-600 rounded-md shadow-sm focus:ring-custom-accent focus:border-custom-accent">
            </div>
            <div>
                <label for="vol20" class="block text-sm font-medium text-gray-300">Vol @20:</label>
                <input type="number" id="vol20" name="vol20" class="mt-1 block w-full bg-custom-dark-secondary text-white border border-gray-600 rounded-md shadow-sm focus:ring-custom-accent focus:border-custom-accent">
            </div>
            <div class="col-span-1 md:col-span-2">
                <label for="excelFile" class="block text-sm font-medium text-gray-300">Upload Excel File:</label>
                <input type="file" id="excelFile" name="excelFile" accept=".xlsx, .xls" class="mt-1 block w-full bg-custom-dark-secondary text-white border border-gray-600 rounded-md shadow-sm focus:ring-custom-accent focus:border-custom-accent">
            </div>
        </div>
        <button type="submit" class="mt-6 w-full py-2 bg-custom-accent text-white rounded-md hover:bg-custom-accent-hover focus:outline-none focus:ring-2 focus:ring-custom-accent focus:ring-offset-2 focus:ring-offset-custom-dark transition-colors duration-300">Submit</button>
    </form>

    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close">Ã—</span>
            <p>Your session will end soon due to inactivity.</p>
        </div>
    </div>

    <div id="resultModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="resultModalContent"></div>
        </div>
    </div>

    <script>
        document.getElementById('excelFile').addEventListener('change', handleFileUpload);

        async function handleFileUpload(event) {
            const file = event.target.files[0];
            
            if (!file) {
                alert("No file selected. Please choose an Excel file.");
                return;
            }

            if (!file.name.match(/\.(xlsx|xls)$/)) {
                alert("Please select a valid Excel file (.xlsx or .xls)");
                returncolor: { value: "#58a6ff" },
                shape: {
                    type: "circle",
                    stroke: { width: 0, color: "#000000" },
                    polygon: { nb_sides: 5 },
                    image: { src: "", width: 100, height: 100 }
                },
                opacity: {
                    value: 0.5,
                    random: false,
                    anim: { enable: false, speed: 1, opacity_min: 0.1, sync: false }
                },
                size: {
                    value: 3,
                    random: true,
                    anim: { enable: false, speed: 40, size_min: 0.1, sync: false }
                },
                line_linked: {
                    enable: true,
                    distance: 150,
                    color: "#58a6ff",
                    opacity: 0.4,
                    width: 1
                },
                move: {
                    enable: true,
                    speed: 6,
                    direction: "none",
                    random: false,
                    straight: false,
                    out_mode: "out",
                    bounce: false,
                    attract: { enable: false, rotateX: 600, rotateY: 1200 }
                }
            },
            interactivity: {
                detect_on: "canvas",
                events: {
                    onhover: { enable: true, mode: "repulse" },
                    onclick: { enable: true, mode: "push" },
                    resize: true
                },
                modes: {
                    grab: { distance: 400, line_linked: { opacity: 1 } },
                    bubble: { distance: 400, size: 40, duration: 2, opacity: 8, speed: 3 },
                    repulse: { distance: 200, duration: 0.4 },
                    push: { particles_nb: 4 },
                    remove: { particles_nb: 2 }
                }
            },
            retina_detect: true
        });
    </script>
</body>
</html>
